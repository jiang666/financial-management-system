# 内部财务系统后端开发计划表

## 📋 项目概览

- **项目名称**：内部财务系统后端
- **开发周期**：12周 (约3个月)
- **技术栈**：Spring Boot 2.7.6 + JPA + Security + MySQL
- **开发团队**：后端开发工程师
- **项目端口**：12139
- **API前缀**：/api

## 📊 当前项目状态

### ✅ 已完成项目基础架构
- [x] Spring Boot 2.7.6 项目搭建
- [x] MySQL数据库连接配置
- [x] 统一响应实体类 (ResponseEntity/ResponsePageDataEntity)
- [x] Spring Security + CORS跨域配置
- [x] BCrypt密码编码器配置
- [x] 日志配置(@Slf4j)
- [x] 健康检查接口 (/health/check)
- [x] 项目可正常编译和启动
- [x] **统一异常处理机制** (BusinessException/ValidationException/DataNotFoundException)
- [x] **参数校验配置** (Bean Validation + 自定义校验)
- [x] **UUID工具类** (标准/32位/批量生成)
- [x] **数据校验工具类** (邮箱/手机/金额/日期等校验)
- [x] **测试接口** (/api/test/* 用于验证各项功能)

### ✅ 用户权限模块完成 (2025-08-19)
- [x] **用户实体类完整实现** (User/Role/Permission + 关联表)
- [x] **Repository层完成** (UserRepository/RoleRepository/PermissionRepository)
- [x] **JWT认证服务完整实现** (JwtTokenProvider/JwtAuthenticationFilter)
- [x] **Spring Security完整配置** (认证授权/异常处理/CORS)
- [x] **用户认证接口完成** (登录/注册/Token刷新/获取用户信息)
- [x] **DTO层完整实现** (LoginDTO/RegisterDTO/UserInfoDTO等)
- [x] **数据库表SQL脚本** (用户权限表结构+默认数据)

### 🟡 部分完成 (Week 2-3 剩余任务)
- [ ] 时间处理工具类 (财务期间、会计年度处理)
- [ ] 基础CRUD模板 (通用增删改查模板)
- [ ] 执行数据库初始化脚本
- [ ] 用户管理CRUD接口

### ❌ 待开发
- [ ] 基于角色的权限控制(RBAC)实现
- [ ] 业务实体类和Repository (科目/凭证等)
- [ ] 核心业务功能模块

**当前完成度**: 约65% (基础架构+用户权限模块完成，JWT认证测试通过)

---

## 🗓️ 开发时间表

### 第一阶段：基础架构搭建 (第1-2周)

#### Week 1: 环境搭建与核心配置

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **MySQL数据库环境搭建** | 🔴高 | 4h | 开发者 | ✅已完成 | 配置MySQL连接 |
| **Spring Boot项目架构完善** | 🔴高 | 6h | 开发者 | ✅已完成 | 统一异常处理、参数校验 |
| **响应实体类完善** | 🔴高 | 4h | 开发者 | ✅已完成 | ResponseEntity优化 |
| **日志配置优化** | 🟡中 | 3h | 开发者 | ✅已完成 | @Slf4j统一配置 |
| **跨域与安全配置** | 🔴高 | 4h | 开发者 | ✅已完成 | CORS + Security基础配置 |
| **系统日志表设计** | 🟡中 | 3h | 开发者 | ✅已完成 | MySQL中的日志表结构 |

**本周目标**：完成开发环境搭建，项目能正常启动并连接MySQL数据库

#### Week 2: 核心工具类与基础服务

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **UUID工具类开发** | 🔴高 | 3h | 开发者 | ✅已完成 | 统一主键生成策略 |
| **数据校验工具类** | 🔴高 | 4h | 开发者 | ✅已完成 | 参数校验、业务规则校验 |
| **时间处理工具类** | 🟡中 | 3h | 开发者 | 待开始 | 财务期间、会计年度处理 |
| **基础CRUD模板** | 🔴高 | 6h | 开发者 | 待开始 | 通用增删改查模板 |
| **分页查询封装** | 🔴高 | 4h | 开发者 | ✅已完成 | ResponsePageDataEntity实现 |

**本周目标**：完成基础工具类和通用服务组件，为业务开发做好准备

---

### 第二阶段：核心功能模块开发 (第3-7周)

#### Week 3: 用户权限模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **用户实体设计** | 🔴高 | 4h | 开发者 | ✅已完成 | User/Role/Permission实体 |
| **权限数据库表设计** | 🔴高 | 4h | 开发者 | ✅已完成 | MySQL表结构设计 |
| **JWT认证服务开发** | 🔴高 | 8h | 开发者 | ✅已完成 | Token生成/验证/刷新 |
| **Spring Security配置** | 🔴高 | 6h | 开发者 | ✅已完成 | 认证授权配置 |
| **用户认证接口开发** | 🔴高 | 8h | 开发者 | ✅已完成 | 注册/登录/Token刷新API |
| **数据库脚本执行** | 🔴高 | 2h | 开发者 | 🟡待执行 | 用户权限表初始化 |
| **用户管理CRUD接口** | 🔴高 | 6h | 开发者 | 🟡待开发 | 用户列表/增删改查 |
| **基于角色权限控制** | 🔴高 | 4h | 开发者 | 🟡待开发 | RBAC实现 |

**本周目标**：✅已完成 JWT认证和用户注册登录功能，待完善用户管理和权限控制

#### Week 4: 基础设置模块 - 科目管理

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **会计科目实体设计** | 🔴高 | 6h | 开发者 | 待开始 | ChartOfAccount实体及关系 |
| **科目树形结构实现** | 🔴高 | 8h | 开发者 | 待开始 | 父子级科目关系处理 |
| **科目编码规则引擎** | 🔴高 | 6h | 开发者 | 待开始 | 自动编码/手动编码逻辑 |
| **辅助核算配置** | 🟡中 | 4h | 开发者 | 待开始 | 部门/客户/供应商核算 |
| **科目管理接口开发** | 🔴高 | 6h | 开发者 | 待开始 | CRUD + 树形查询API |

**本周目标**：完成会计科目管理功能，支持多级科目和辅助核算

#### Week 5: 基础设置模块 - 币种汇率与期初

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **币种管理实体设计** | 🔴高 | 4h | 开发者 | 待开始 | Currency/ExchangeRate实体 |
| **汇率管理服务** | 🔴高 | 6h | 开发者 | 待开始 | 汇率类型/自动获取/调汇 |
| **期初余额管理** | 🔴高 | 8h | 开发者 | 待开始 | 余额录入/试算平衡 |
| **Excel导入功能** | 🟡中 | 6h | 开发者 | 待开始 | 期初余额批量导入 |
| **数据校验服务** | 🔴高 | 6h | 开发者 | 待开始 | 借贷平衡/报表平衡检查 |

**本周目标**：完成币种汇率和期初余额管理，确保数据准确性

#### Week 6: 总账管理模块 - 凭证管理

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **凭证实体设计** | 🔴高 | 6h | 开发者 | 待开始 | Voucher/VoucherEntry实体 |
| **凭证录入服务** | 🔴高 | 10h | 开发者 | 待开始 | 凭证头/分录/借贷平衡 |
| **凭证审核工作流** | 🔴高 | 8h | 开发者 | 待开始 | 单级/多级审核流程 |
| **凭证记账处理** | 🔴高 | 6h | 开发者 | 待开始 | 批量记账/账簿更新 |
| **凭证查询接口** | 🟡中 | 4h | 开发者 | 待开始 | 多条件查询/分页 |

**本周目标**：完成凭证核心功能，实现完整的凭证处理流程

#### Week 7: 总账管理模块 - 账簿查询

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **总账查询服务** | 🔴高 | 6h | 开发者 | 待开始 | 科目余额/发生额查询 |
| **明细账查询服务** | 🔴高 | 6h | 开发者 | 待开始 | 科目明细/辅助核算明细 |
| **多栏账实现** | 🟡中 | 8h | 开发者 | 待开始 | 费用/收入多栏账 |
| **日记账服务** | 🟡中 | 4h | 开发者 | 待开始 | 现金/银行日记账 |
| **期末结账处理** | 🔴高 | 6h | 开发者 | 待开始 | 损益结转/调汇/结账 |

**本周目标**：完成账簿查询和期末处理功能

---

### 第三阶段：业务流程集成 (第8-9周)

#### Week 8: 出纳管理模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **现金管理实体设计** | 🔴高 | 4h | 开发者 | 待开始 | 现金日记账/盘点 |
| **银行账户管理** | 🔴高 | 6h | 开发者 | 待开始 | 银行日记账/多账户 |
| **银行对账功能** | 🔴高 | 10h | 开发者 | 待开始 | 自动对账/手工对账 |
| **支票管理系统** | 🟡中 | 6h | 开发者 | 待开始 | 申领/开具/核销 |
| **资金日报表** | 🟡中 | 4h | 开发者 | 待开始 | 自动生成/推送 |

**本周目标**：完成出纳管理核心功能，实现资金管控

#### Week 9: 往来账款模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **客户供应商管理** | 🔴高 | 6h | 开发者 | 待开始 | 基础档案管理 |
| **发票管理系统** | 🔴高 | 8h | 开发者 | 待开始 | 销售发票/采购发票 |
| **应收款管理** | 🔴高 | 8h | 开发者 | 待开始 | 应收确认/收款核销 |
| **应付款管理** | 🔴高 | 8h | 开发者 | 待开始 | 应付确认/付款管理 |
| **账龄分析功能** | 🟡中 | 4h | 开发者 | 待开始 | 多维度账龄分析 |

**本周目标**：完成往来账款管理，实现收付款业务闭环

#### Week 9: 成本管理模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **成本对象管理** | 🔴高 | 4h | 开发者 | 待开始 | 产品/项目/部门 |
| **直接成本核算** | 🔴高 | 8h | 开发者 | 待开始 | 材料成本/人工成本 |
| **制造费用分配** | 🔴高 | 8h | 开发者 | 待开始 | 费用归集/分配算法 |
| **成本计算引擎** | 🔴高 | 8h | 开发者 | 待开始 | 品种法/分批法/分步法 |
| **成本分析报表** | 🟡中 | 4h | 开发者 | 待开始 | 成本对比/差异分析 |

**本周目标**：完成成本管理核心功能

---

### 第四阶段：高级功能开发 (第10-11周)

#### Week 10: 预算管理模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **预算体系设计** | 🔴高 | 6h | 开发者 | 待开始 | 预算维度/科目设置 |
| **预算编制功能** | 🔴高 | 8h | 开发者 | 待开始 | 模板/编制方式 |
| **预算审批流程** | 🔴高 | 6h | 开发者 | 待开始 | 多级审批工作流 |
| **预算控制引擎** | 🔴高 | 8h | 开发者 | 待开始 | 事前/事中/事后控制 |
| **预算分析报表** | 🟡中 | 4h | 开发者 | 待开始 | 执行分析/差异分析 |

**本周目标**：完成预算管理系统

#### Week 11: 财务分析与报表模块

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **财务报表引擎** | 🔴高 | 8h | 开发者 | 待开始 | 资产负债表/利润表 |
| **财务指标计算** | 🔴高 | 6h | 开发者 | 待开始 | 盈利能力/偿债能力分析 |
| **数据透视分析** | 🟡中 | 6h | 开发者 | 待开始 | 多维度数据分析 |
| **Excel导出功能** | 🟡中 | 6h | 开发者 | 待开始 | 报表导出/格式化 |
| **图表数据接口** | 🟡中 | 4h | 开发者 | 待开始 | 前端图表数据支持 |

**本周目标**：完成财务分析和报表功能

---

### 第五阶段：性能优化与测试 (第12周)

#### Week 12: 性能优化与测试

| 任务 | 优先级 | 预计工时 | 负责人 | 状态 | 备注 |
|-----|--------|----------|---------|------|------|
| **数据库查询优化** | 🔴高 | 6h | 开发者 | 待开始 | 索引优化/查询语句优化 |
| **分页性能优化** | 🔴高 | 4h | 开发者 | 待开始 | 大数据量分页优化 |
| **单元测试完善** | 🔴高 | 8h | 开发者 | 待开始 | 覆盖率达到80% |
| **集成测试执行** | 🔴高 | 6h | 开发者 | 待开始 | 模块间集成测试 |
| **安全测试验证** | 🔴高 | 4h | 开发者 | 待开始 | SQL注入/XSS防护 |
| **接口性能测试** | 🟡中 | 4h | 开发者 | 待开始 | 响应时间/并发测试 |

**本周目标**：完成性能优化和全面测试，确保系统可以投入生产使用

---

## 🎯 关键里程碑

| 里程碑 | 时间节点 | 交付物 | 验收标准 | 状态 |
|--------|----------|---------|----------|------|
| **架构搭建完成** | Week 2 | 基础项目框架 | MySQL连接正常，基础服务可用 | ✅已完成 |
| **权限模块完成** | Week 3 | 用户权限系统 | JWT认证正常，权限控制有效 | 🟡部分完成 |
| **基础设置完成** | Week 5 | 科目币种期初 | 科目体系完整，期初平衡 | ❌待开始 |
| **凭证系统完成** | Week 7 | 总账管理系统 | 凭证流程完整，账簿查询正确 | ❌待开始 |
| **主要业务完成** | Week 9 | 出纳往来成本 | 业务流程闭环，数据准确 | ❌待开始 |
| **系统功能完整** | Week 11 | 预算分析功能 | 功能模块齐全，报表完善 | ❌待开始 |
| **系统发布就绪** | Week 12 | 完整系统 | 性能达标，测试通过 | ❌待开始 |

---

## 🔧 技术规范检查清单

### 代码规范
- [ ] 所有类使用@Slf4j注解
- [ ] 实体类使用UUID主键
- [ ] 接口统一使用ResponseEntity返回
- [ ] 数据库操作使用Spring Data JPA
- [ ] 权限控制使用@PreAuthorize
- [ ] 异常处理统一规范

### 数据库规范
- [ ] MySQL存储所有业务数据
- [ ] 系统日志存储在MySQL中
- [ ] 表名使用snake_case命名
- [ ] 重要字段建立索引
- [ ] 主键统一使用UUID
- [ ] 审计字段完整(created_at/updated_at)

### 安全规范
- [ ] 密码使用BCrypt加密
- [ ] 使用JWT Token认证
- [ ] SQL注入防护到位
- [ ] 敏感数据脱敏处理
- [ ] 接口权限控制完善

### 性能规范
- [ ] 关键接口响应时间<1s
- [ ] 分页查询优化
- [ ] 数据库连接池配置合理
- [ ] 大数据量查询分批处理

---

## 📊 风险评估与应对

| 风险项 | 风险等级 | 影响 | 应对措施 |
|--------|----------|------|----------|
| **技术栈学习成本** | 🟡中 | 开发进度 | 提前技术调研，分模块学习 |
| **业务逻辑复杂性** | 🔴高 | 功能质量 | 与业务人员充分沟通，分阶段验证 |
| **数据库性能问题** | 🟡中 | 系统性能 | 提前进行性能测试，优化查询 |
| **财务数据准确性** | 🔴高 | 数据质量 | 严格数据校验，完善测试用例 |
| **报表性能瓶颈** | 🟡中 | 用户体验 | 优化查询语句，考虑数据预处理 |

---

## 📈 质量保证措施

### 代码质量
- 代码评审制度
- 单元测试覆盖率要求
- 静态代码分析
- 编码规范检查

### 功能质量
- 业务需求评审
- 功能测试用例
- 集成测试验证
- 用户验收测试

### 性能质量
- 性能基准设定
- 压力测试执行
- 性能监控部署
- 优化方案实施

---

## 🚀 后续规划

### 版本规划
- **V1.0**：核心财务功能 (Week 1-9)
- **V1.1**：预算管理功能 (Week 10)
- **V1.2**：财务分析功能 (Week 11)
- **V2.0**：高级扩展功能 (后续规划)

### 持续改进
- 用户反馈收集
- 性能持续优化
- 功能迭代升级
- 技术栈更新

---

**文档版本**：V1.1  
**创建日期**：2025-01-19  
**最后更新**：2025-08-19  
**维护人员**：后端开发团队

---

## 📅 更新日志

### V1.2 (2025-08-19 最新)
- ✅ 用户权限模块开发完成（JWT认证、用户实体、权限体系）
- ✅ JWT认证问题修复（密钥长度、路径配置、WeakKeyException）
- ✅ 用户认证接口完整实现（登录/注册/Token刷新/获取用户信息）
- ✅ Spring Security完整配置（认证授权/异常处理/CORS支持）
- 🔄 进度更新：从35%提升到65%，核心认证功能已完成并测试通过
- ⏭️ 下一步：执行数据库脚本、完善用户管理CRUD、实现RBAC权限控制

### V1.1 (2025-08-19)
- ✅ 检查当前代码完成情况
- ✅ 更新任务完成状态
- ✅ 添加当前项目状态总览  
- ✅ 标记已完成的基础架构任务
- 🔄 项目基础架构已基本完成，可开始核心业务开发

### V1.0 (2025-01-19)
- ✅ 初始版本创建
- ✅ 完整的12周开发计划制定
- ✅ 技术栈简化(移除MongoDB/PostgreSQL)