# 内部财务管理系统数据库表结构设计 (重构版)

## 1. 设计原则与约束

### 1.1 基本约束
- **主键**: 所有表使用 UUID (VARCHAR(36))
- **字符集**: UTF-8MB4
- **时间字段**: 使用 BIGINT 存储毫秒时间戳
- **逻辑删除**: 使用 `deleted` 字段 (TINYINT(1))
- **审计字段**: created_at, updated_at, created_by, updated_by
- **金额字段**: DECIMAL(15,2) 确保精度

### 1.2 命名规范
- 表名: 小写下划线分隔
- 字段名: 小写下划线分隔
- 索引名: idx_表名_字段名
- 外键名: fk_表名_引用表名

## 2. 核心业务表结构

### 2.1 用户权限管理模块

#### 2.1.1 用户表 (tb_user)
```sql
CREATE TABLE IF NOT EXISTS tb_user (
    id VARCHAR(36) NOT NULL COMMENT '用户唯一标识，UUID',
    create_time BIGINT NOT NULL COMMENT '创建时间，毫秒时间戳',
    update_time BIGINT NOT NULL COMMENT '更新时间，毫秒时间戳',
    create_by VARCHAR(50) NOT NULL COMMENT '创建人，登录账号',
    update_by VARCHAR(50) NOT NULL COMMENT '更新人，登录账号',
    username VARCHAR(50) NOT NULL COMMENT '用户名',
    password VARCHAR(255) NOT NULL COMMENT '密码(加密)',
    real_name VARCHAR(50) COMMENT '真实姓名',
    email VARCHAR(100) COMMENT '邮箱',
    phone VARCHAR(20) COMMENT '手机号',
    department VARCHAR(100) COMMENT '部门名称',
    department_id VARCHAR(36) COMMENT '部门ID，关联tb_department.id',
    status VARCHAR(10) NOT NULL DEFAULT 'ACTIVE' COMMENT '状态: ACTIVE-启用 INACTIVE-停用',
    last_login_at BIGINT COMMENT '最后登录时间，毫秒时间戳',
    last_login_ip VARCHAR(45) COMMENT '最后登录IP',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除: 0-否 1-是',
    PRIMARY KEY (id),
    UNIQUE KEY uk_username (username),
    UNIQUE KEY uk_email (email)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户信息表';

-- 索引
CREATE INDEX idx_user_phone ON tb_user(phone);
CREATE INDEX idx_user_department_id ON tb_user(department_id);
CREATE INDEX idx_user_status ON tb_user(status);
CREATE INDEX idx_user_deleted ON tb_user(deleted);
```

#### 2.1.2 角色表 (tb_role)
```sql
CREATE TABLE IF NOT EXISTS tb_role (
    id VARCHAR(36) NOT NULL COMMENT '角色唯一标识，UUID',
    create_time BIGINT NOT NULL COMMENT '创建时间，毫秒时间戳',
    update_time BIGINT NOT NULL COMMENT '更新时间，毫秒时间戳',
    create_by VARCHAR(50) NOT NULL COMMENT '创建人，登录账号',
    update_by VARCHAR(50) NOT NULL COMMENT '更新人，登录账号',
    role_code VARCHAR(100) NOT NULL COMMENT '角色编码',
    name VARCHAR(50) NOT NULL COMMENT '角色名称',
    description VARCHAR(200) COMMENT '角色描述',
    status VARCHAR(10) NOT NULL DEFAULT 'ACTIVE' COMMENT '状态: ACTIVE-启用 INACTIVE-停用',
    can_delete TINYINT(1) NOT NULL DEFAULT 1 COMMENT '是否可以删除: 0-否 1-是',
    can_modify TINYINT(1) NOT NULL DEFAULT 1 COMMENT '是否可以编辑: 0-否 1-是',
    user_count INT NOT NULL DEFAULT 0 COMMENT '使用该角色的用户数量',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除: 0-否 1-是',
    PRIMARY KEY (id),
    UNIQUE KEY uk_role_code (role_code),
    UNIQUE KEY uk_role_name (name)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='角色信息表';

-- 索引
CREATE INDEX idx_role_status ON tb_role(status);
CREATE INDEX idx_role_deleted ON tb_role(deleted);
```

#### 2.1.3 资源表 (tb_resource)
```sql
CREATE TABLE IF NOT EXISTS tb_resource (
    id VARCHAR(36) NOT NULL COMMENT '资源唯一标识，UUID',
    create_time BIGINT NOT NULL COMMENT '创建时间，毫秒时间戳',
    update_time BIGINT NOT NULL COMMENT '更新时间，毫秒时间戳',
    create_by VARCHAR(50) NOT NULL COMMENT '创建人，登录账号',
    update_by VARCHAR(50) NOT NULL COMMENT '更新人，登录账号',
    resource_code VARCHAR(100) COMMENT '资源编码',
    resource_name VARCHAR(100) NOT NULL COMMENT '资源名称',
    resource_type VARCHAR(50) NOT NULL COMMENT '资源类型: TOP_MENU-顶级菜单 SUB_MENU-子菜单 BUTTON-按钮 API-接口',
    parent_id VARCHAR(36) COMMENT '父资源ID',
    url VARCHAR(200) COMMENT '访问路径',
    icon VARCHAR(50) COMMENT '图标',
    sort_order INT DEFAULT 0 COMMENT '显示排序',
    path VARCHAR(500) COMMENT '层级路径，如: /1/2/3',
    level INT NOT NULL DEFAULT 1 COMMENT '层级深度',
    description VARCHAR(200) COMMENT '资源描述',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除: 0-否 1-是',
    PRIMARY KEY (id),
    UNIQUE KEY uk_resource_code (resource_code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='资源权限表';

-- 索引
CREATE INDEX idx_resource_parent_id ON tb_resource(parent_id);
CREATE INDEX idx_resource_type ON tb_resource(resource_type);
CREATE INDEX idx_resource_url ON tb_resource(url);
CREATE INDEX idx_resource_deleted ON tb_resource(deleted);
```

#### 2.1.4 用户角色关联表 (tb_user_role)
```sql
CREATE TABLE IF NOT EXISTS tb_user_role (
    id VARCHAR(36) NOT NULL COMMENT '关联唯一标识，UUID',
    create_time BIGINT NOT NULL COMMENT '创建时间，毫秒时间戳',
    create_by VARCHAR(50) NOT NULL COMMENT '创建人，登录账号',
    user_id VARCHAR(36) NOT NULL COMMENT '用户ID，关联tb_user.id',
    role_id VARCHAR(36) NOT NULL COMMENT '角色ID，关联tb_role.id',
    PRIMARY KEY (id),
    UNIQUE KEY uk_user_role (user_id, role_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户角色关联表';

-- 索引（注意：根据约束文档，不使用外键约束）
CREATE INDEX idx_user_role_user_id ON tb_user_role(user_id);
CREATE INDEX idx_user_role_role_id ON tb_user_role(role_id);
```

#### 2.1.5 角色资源关联表 (tb_role_resource)
```sql
CREATE TABLE IF NOT EXISTS tb_role_resource (
    id VARCHAR(36) NOT NULL COMMENT '关联唯一标识，UUID',
    create_time BIGINT NOT NULL COMMENT '创建时间，毫秒时间戳',
    create_by VARCHAR(50) NOT NULL COMMENT '创建人，登录账号',
    role_id VARCHAR(36) NOT NULL COMMENT '角色ID，关联tb_role.id',
    resource_id VARCHAR(36) NOT NULL COMMENT '资源ID，关联tb_resource.id',
    PRIMARY KEY (id),
    UNIQUE KEY uk_role_resource (role_id, resource_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='角色资源关联表';

-- 索引（注意：根据约束文档，不使用外键约束）
CREATE INDEX idx_role_resource_role_id ON tb_role_resource(role_id);
CREATE INDEX idx_role_resource_resource_id ON tb_role_resource(resource_id);
```

### 2.2 组织架构模块

#### 2.2.1 部门表 (departments)
```sql
CREATE TABLE departments (
    id VARCHAR(36) PRIMARY KEY COMMENT '部门ID',
    code VARCHAR(50) NOT NULL UNIQUE COMMENT '部门编码',
    name VARCHAR(100) NOT NULL COMMENT '部门名称',
    parent_id VARCHAR(36) COMMENT '上级部门ID',
    level INT NOT NULL DEFAULT 1 COMMENT '层级',
    path VARCHAR(500) COMMENT '层级路径',
    manager_id VARCHAR(36) COMMENT '部门负责人ID',
    contact_phone VARCHAR(20) COMMENT '联系电话',
    description TEXT COMMENT '部门描述',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    sort_order INT DEFAULT 0 COMMENT '排序',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 外键
ALTER TABLE departments ADD CONSTRAINT fk_departments_parent FOREIGN KEY (parent_id) REFERENCES departments(id);
ALTER TABLE departments ADD CONSTRAINT fk_departments_manager FOREIGN KEY (manager_id) REFERENCES users(id);

-- 索引
CREATE INDEX idx_departments_code ON departments(code);
CREATE INDEX idx_departments_parent_id ON departments(parent_id);
CREATE INDEX idx_departments_level ON departments(level);
CREATE INDEX idx_departments_status ON departments(status);
CREATE INDEX idx_departments_deleted ON departments(deleted);
```

### 2.3 会计科目管理模块

#### 2.3.1 会计科目表 (chart_of_accounts)
```sql
CREATE TABLE chart_of_accounts (
    id VARCHAR(36) PRIMARY KEY COMMENT '科目ID',
    code VARCHAR(20) NOT NULL UNIQUE COMMENT '科目编码',
    name VARCHAR(100) NOT NULL COMMENT '科目名称',
    name_en VARCHAR(100) COMMENT '英文名称',
    parent_id VARCHAR(36) COMMENT '上级科目ID',
    level INT NOT NULL DEFAULT 1 COMMENT '科目层级',
    path VARCHAR(500) COMMENT '层级路径',
    account_type ENUM('ASSET', 'LIABILITY', 'EQUITY', 'INCOME', 'EXPENSE') NOT NULL COMMENT '科目类型',
    balance_direction ENUM('DEBIT', 'CREDIT') NOT NULL COMMENT '余额方向',
    is_leaf TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否叶子节点',
    allow_manual_entry TINYINT(1) NOT NULL DEFAULT 1 COMMENT '是否允许手工录入',
    currency_id VARCHAR(36) COMMENT '币种ID',
    auxiliary_type VARCHAR(50) COMMENT '辅助核算类型',
    auxiliary_info JSON COMMENT '辅助核算信息',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    sort_order INT DEFAULT 0 COMMENT '排序',
    description TEXT COMMENT '科目说明',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 外键
ALTER TABLE chart_of_accounts ADD CONSTRAINT fk_accounts_parent FOREIGN KEY (parent_id) REFERENCES chart_of_accounts(id);

-- 索引
CREATE INDEX idx_accounts_code ON chart_of_accounts(code);
CREATE INDEX idx_accounts_parent_id ON chart_of_accounts(parent_id);
CREATE INDEX idx_accounts_type ON chart_of_accounts(account_type);
CREATE INDEX idx_accounts_level ON chart_of_accounts(level);
CREATE INDEX idx_accounts_is_leaf ON chart_of_accounts(is_leaf);
CREATE INDEX idx_accounts_status ON chart_of_accounts(status);
CREATE INDEX idx_accounts_deleted ON chart_of_accounts(deleted);
```

#### 2.3.2 币种表 (currencies)
```sql
CREATE TABLE currencies (
    id VARCHAR(36) PRIMARY KEY COMMENT '币种ID',
    code VARCHAR(3) NOT NULL UNIQUE COMMENT '币种代码',
    name VARCHAR(50) NOT NULL COMMENT '币种名称',
    name_en VARCHAR(50) COMMENT '英文名称',
    symbol VARCHAR(10) COMMENT '币种符号',
    is_base TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否本位币',
    decimal_places INT NOT NULL DEFAULT 2 COMMENT '小数位数',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    sort_order INT DEFAULT 0 COMMENT '排序',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 索引
CREATE INDEX idx_currencies_code ON currencies(code);
CREATE INDEX idx_currencies_is_base ON currencies(is_base);
CREATE INDEX idx_currencies_status ON currencies(status);
CREATE INDEX idx_currencies_deleted ON currencies(deleted);
```

#### 2.3.3 汇率表 (exchange_rates)
```sql
CREATE TABLE exchange_rates (
    id VARCHAR(36) PRIMARY KEY COMMENT '汇率ID',
    from_currency_id VARCHAR(36) NOT NULL COMMENT '源币种ID',
    to_currency_id VARCHAR(36) NOT NULL COMMENT '目标币种ID',
    rate DECIMAL(15,8) NOT NULL COMMENT '汇率',
    rate_type ENUM('SPOT', 'FORWARD', 'AVERAGE') NOT NULL DEFAULT 'SPOT' COMMENT '汇率类型',
    effective_date BIGINT NOT NULL COMMENT '生效日期',
    expiry_date BIGINT COMMENT '失效日期',
    source VARCHAR(50) COMMENT '汇率来源',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 外键
ALTER TABLE exchange_rates ADD CONSTRAINT fk_exchange_rates_from FOREIGN KEY (from_currency_id) REFERENCES currencies(id);
ALTER TABLE exchange_rates ADD CONSTRAINT fk_exchange_rates_to FOREIGN KEY (to_currency_id) REFERENCES currencies(id);

-- 索引
CREATE INDEX idx_exchange_rates_from_to ON exchange_rates(from_currency_id, to_currency_id);
CREATE INDEX idx_exchange_rates_effective_date ON exchange_rates(effective_date);
CREATE INDEX idx_exchange_rates_status ON exchange_rates(status);
CREATE INDEX idx_exchange_rates_deleted ON exchange_rates(deleted);
```

#### 2.3.4 期初余额表 (initial_balances)
```sql
CREATE TABLE initial_balances (
    id VARCHAR(36) PRIMARY KEY COMMENT '期初余额ID',
    account_id VARCHAR(36) NOT NULL COMMENT '科目ID',
    currency_id VARCHAR(36) NOT NULL COMMENT '币种ID',
    fiscal_year INT NOT NULL COMMENT '会计年度',
    period INT NOT NULL DEFAULT 0 COMMENT '期间(0表示年初)',
    debit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '借方金额',
    credit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '贷方金额',
    auxiliary_info JSON COMMENT '辅助核算信息',
    status ENUM('DRAFT', 'CONFIRMED', 'LOCKED') NOT NULL DEFAULT 'DRAFT' COMMENT '状态',
    confirmed_at BIGINT COMMENT '确认时间',
    confirmed_by VARCHAR(36) COMMENT '确认人',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除',
    UNIQUE KEY uk_initial_balance (account_id, currency_id, fiscal_year, period)
);

-- 外键
ALTER TABLE initial_balances ADD CONSTRAINT fk_initial_balances_account FOREIGN KEY (account_id) REFERENCES chart_of_accounts(id);
ALTER TABLE initial_balances ADD CONSTRAINT fk_initial_balances_currency FOREIGN KEY (currency_id) REFERENCES currencies(id);

-- 索引
CREATE INDEX idx_initial_balances_account_id ON initial_balances(account_id);
CREATE INDEX idx_initial_balances_fiscal_year ON initial_balances(fiscal_year);
CREATE INDEX idx_initial_balances_status ON initial_balances(status);
CREATE INDEX idx_initial_balances_deleted ON initial_balances(deleted);
```

### 2.4 凭证管理模块

#### 2.4.1 凭证主表 (vouchers)
```sql
CREATE TABLE vouchers (
    id VARCHAR(36) PRIMARY KEY COMMENT '凭证ID',
    voucher_no VARCHAR(50) NOT NULL COMMENT '凭证号',
    voucher_type ENUM('RECEIPT', 'PAYMENT', 'TRANSFER', 'GENERAL') NOT NULL COMMENT '凭证类型',
    fiscal_year INT NOT NULL COMMENT '会计年度',
    period INT NOT NULL COMMENT '会计期间',
    voucher_date BIGINT NOT NULL COMMENT '凭证日期',
    description TEXT COMMENT '摘要',
    total_debit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '借方合计金额',
    total_credit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '贷方合计金额',
    attachment_count INT NOT NULL DEFAULT 0 COMMENT '附件数量',
    status ENUM('DRAFT', 'PENDING', 'APPROVED', 'REJECTED', 'POSTED') NOT NULL DEFAULT 'DRAFT' COMMENT '状态',
    created_by VARCHAR(36) COMMENT '制单人',
    reviewed_by VARCHAR(36) COMMENT '审核人',
    reviewed_at BIGINT COMMENT '审核时间',
    posted_by VARCHAR(36) COMMENT '记账人',
    posted_at BIGINT COMMENT '记账时间',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除',
    version INT NOT NULL DEFAULT 1 COMMENT '版本号'
);

-- 索引
CREATE UNIQUE INDEX uk_voucher_no_year_period ON vouchers(voucher_no, fiscal_year, period);
CREATE INDEX idx_vouchers_type ON vouchers(voucher_type);
CREATE INDEX idx_vouchers_date ON vouchers(voucher_date);
CREATE INDEX idx_vouchers_period ON vouchers(fiscal_year, period);
CREATE INDEX idx_vouchers_status ON vouchers(status);
CREATE INDEX idx_vouchers_created_by ON vouchers(created_by);
CREATE INDEX idx_vouchers_deleted ON vouchers(deleted);
```

#### 2.4.2 凭证分录表 (voucher_entries)
```sql
CREATE TABLE voucher_entries (
    id VARCHAR(36) PRIMARY KEY COMMENT '分录ID',
    voucher_id VARCHAR(36) NOT NULL COMMENT '凭证ID',
    line_no INT NOT NULL COMMENT '分录行号',
    account_id VARCHAR(36) NOT NULL COMMENT '科目ID',
    currency_id VARCHAR(36) NOT NULL COMMENT '币种ID',
    exchange_rate DECIMAL(15,8) DEFAULT 1.00000000 COMMENT '汇率',
    debit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '借方金额',
    credit_amount DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '贷方金额',
    debit_amount_base DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '借方本位币金额',
    credit_amount_base DECIMAL(15,2) NOT NULL DEFAULT 0.00 COMMENT '贷方本位币金额',
    description TEXT COMMENT '摘要',
    auxiliary_info JSON COMMENT '辅助核算信息',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人'
);

-- 外键
ALTER TABLE voucher_entries ADD CONSTRAINT fk_voucher_entries_voucher FOREIGN KEY (voucher_id) REFERENCES vouchers(id);
ALTER TABLE voucher_entries ADD CONSTRAINT fk_voucher_entries_account FOREIGN KEY (account_id) REFERENCES chart_of_accounts(id);
ALTER TABLE voucher_entries ADD CONSTRAINT fk_voucher_entries_currency FOREIGN KEY (currency_id) REFERENCES currencies(id);

-- 索引
CREATE INDEX idx_voucher_entries_voucher_id ON voucher_entries(voucher_id);
CREATE INDEX idx_voucher_entries_account_id ON voucher_entries(account_id);
CREATE INDEX idx_voucher_entries_line_no ON voucher_entries(voucher_id, line_no);
```

### 2.5 往来账款模块

#### 2.5.1 客户档案表 (customers)
```sql
CREATE TABLE customers (
    id VARCHAR(36) PRIMARY KEY COMMENT '客户ID',
    code VARCHAR(50) NOT NULL UNIQUE COMMENT '客户编码',
    name VARCHAR(200) NOT NULL COMMENT '客户名称',
    name_en VARCHAR(200) COMMENT '英文名称',
    short_name VARCHAR(100) COMMENT '客户简称',
    customer_type ENUM('INDIVIDUAL', 'COMPANY', 'GOVERNMENT') NOT NULL COMMENT '客户类型',
    industry VARCHAR(100) COMMENT '所属行业',
    contact_person VARCHAR(50) COMMENT '联系人',
    contact_phone VARCHAR(20) COMMENT '联系电话',
    contact_email VARCHAR(100) COMMENT '联系邮箱',
    address TEXT COMMENT '地址',
    postal_code VARCHAR(20) COMMENT '邮政编码',
    tax_number VARCHAR(50) COMMENT '税号',
    bank_name VARCHAR(100) COMMENT '开户银行',
    bank_account VARCHAR(50) COMMENT '银行账号',
    credit_limit DECIMAL(15,2) DEFAULT 0.00 COMMENT '信用额度',
    payment_terms INT DEFAULT 0 COMMENT '付款期限(天)',
    currency_id VARCHAR(36) COMMENT '结算币种ID',
    sales_rep_id VARCHAR(36) COMMENT '销售代表ID',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    notes TEXT COMMENT '备注',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 外键
ALTER TABLE customers ADD CONSTRAINT fk_customers_currency FOREIGN KEY (currency_id) REFERENCES currencies(id);
ALTER TABLE customers ADD CONSTRAINT fk_customers_sales_rep FOREIGN KEY (sales_rep_id) REFERENCES users(id);

-- 索引
CREATE INDEX idx_customers_code ON customers(code);
CREATE INDEX idx_customers_name ON customers(name);
CREATE INDEX idx_customers_type ON customers(customer_type);
CREATE INDEX idx_customers_status ON customers(status);
CREATE INDEX idx_customers_deleted ON customers(deleted);
```

#### 2.5.2 供应商档案表 (suppliers)
```sql
CREATE TABLE suppliers (
    id VARCHAR(36) PRIMARY KEY COMMENT '供应商ID',
    code VARCHAR(50) NOT NULL UNIQUE COMMENT '供应商编码',
    name VARCHAR(200) NOT NULL COMMENT '供应商名称',
    name_en VARCHAR(200) COMMENT '英文名称',
    short_name VARCHAR(100) COMMENT '供应商简称',
    supplier_type ENUM('INDIVIDUAL', 'COMPANY', 'GOVERNMENT') NOT NULL COMMENT '供应商类型',
    business_scope VARCHAR(200) COMMENT '经营范围',
    contact_person VARCHAR(50) COMMENT '联系人',
    contact_phone VARCHAR(20) COMMENT '联系电话',
    contact_email VARCHAR(100) COMMENT '联系邮箱',
    address TEXT COMMENT '地址',
    postal_code VARCHAR(20) COMMENT '邮政编码',
    tax_number VARCHAR(50) COMMENT '税号',
    bank_name VARCHAR(100) COMMENT '开户银行',
    bank_account VARCHAR(50) COMMENT '银行账号',
    payment_terms INT DEFAULT 0 COMMENT '付款期限(天)',
    currency_id VARCHAR(36) COMMENT '结算币种ID',
    purchaser_id VARCHAR(36) COMMENT '采购员ID',
    status TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 1-启用 0-禁用',
    notes TEXT COMMENT '备注',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    deleted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除'
);

-- 外键
ALTER TABLE suppliers ADD CONSTRAINT fk_suppliers_currency FOREIGN KEY (currency_id) REFERENCES currencies(id);
ALTER TABLE suppliers ADD CONSTRAINT fk_suppliers_purchaser FOREIGN KEY (purchaser_id) REFERENCES users(id);

-- 索引
CREATE INDEX idx_suppliers_code ON suppliers(code);
CREATE INDEX idx_suppliers_name ON suppliers(name);
CREATE INDEX idx_suppliers_type ON suppliers(supplier_type);
CREATE INDEX idx_suppliers_status ON suppliers(status);
CREATE INDEX idx_suppliers_deleted ON suppliers(deleted);
```

### 2.6 系统日志模块

#### 2.6.1 系统操作日志表 (system_logs)
```sql
CREATE TABLE system_logs (
    id VARCHAR(36) PRIMARY KEY COMMENT '日志ID',
    user_id VARCHAR(36) COMMENT '操作用户ID',
    username VARCHAR(50) COMMENT '用户名',
    module VARCHAR(50) NOT NULL COMMENT '操作模块',
    action VARCHAR(50) NOT NULL COMMENT '操作动作',
    resource_type VARCHAR(50) COMMENT '资源类型',
    resource_id VARCHAR(36) COMMENT '资源ID',
    description TEXT COMMENT '操作描述',
    request_method VARCHAR(10) COMMENT '请求方法',
    request_url VARCHAR(500) COMMENT '请求URL',
    request_params TEXT COMMENT '请求参数',
    response_code INT COMMENT '响应状态码',
    response_message TEXT COMMENT '响应消息',
    ip_address VARCHAR(45) COMMENT 'IP地址',
    user_agent TEXT COMMENT '用户代理',
    execution_time BIGINT COMMENT '执行时间(毫秒)',
    log_level ENUM('DEBUG', 'INFO', 'WARN', 'ERROR') NOT NULL DEFAULT 'INFO' COMMENT '日志级别',
    created_at BIGINT NOT NULL COMMENT '创建时间'
);

-- 外键
ALTER TABLE system_logs ADD CONSTRAINT fk_system_logs_user FOREIGN KEY (user_id) REFERENCES users(id);

-- 索引
CREATE INDEX idx_system_logs_user_id ON system_logs(user_id);
CREATE INDEX idx_system_logs_module ON system_logs(module);
CREATE INDEX idx_system_logs_action ON system_logs(action);
CREATE INDEX idx_system_logs_created_at ON system_logs(created_at);
CREATE INDEX idx_system_logs_level ON system_logs(log_level);
```

#### 2.6.2 登录日志表 (login_logs)
```sql
CREATE TABLE login_logs (
    id VARCHAR(36) PRIMARY KEY COMMENT '登录日志ID',
    user_id VARCHAR(36) COMMENT '用户ID',
    username VARCHAR(50) NOT NULL COMMENT '用户名',
    login_type ENUM('PASSWORD', 'TOKEN', 'SSO') NOT NULL DEFAULT 'PASSWORD' COMMENT '登录方式',
    status ENUM('SUCCESS', 'FAILED', 'LOCKED') NOT NULL COMMENT '登录状态',
    ip_address VARCHAR(45) COMMENT 'IP地址',
    user_agent TEXT COMMENT '用户代理',
    location VARCHAR(100) COMMENT '登录地点',
    failure_reason VARCHAR(200) COMMENT '失败原因',
    session_id VARCHAR(100) COMMENT '会话ID',
    login_at BIGINT NOT NULL COMMENT '登录时间',
    logout_at BIGINT COMMENT '登出时间',
    session_duration BIGINT COMMENT '会话时长(毫秒)'
);

-- 外键
ALTER TABLE login_logs ADD CONSTRAINT fk_login_logs_user FOREIGN KEY (user_id) REFERENCES users(id);

-- 索引
CREATE INDEX idx_login_logs_user_id ON login_logs(user_id);
CREATE INDEX idx_login_logs_username ON login_logs(username);
CREATE INDEX idx_login_logs_status ON login_logs(status);
CREATE INDEX idx_login_logs_login_at ON login_logs(login_at);
CREATE INDEX idx_login_logs_ip_address ON login_logs(ip_address);
```

### 2.7 系统配置模块

#### 2.7.1 系统参数表 (system_parameters)
```sql
CREATE TABLE system_parameters (
    id VARCHAR(36) PRIMARY KEY COMMENT '参数ID',
    param_key VARCHAR(100) NOT NULL UNIQUE COMMENT '参数键',
    param_value TEXT COMMENT '参数值',
    param_type ENUM('STRING', 'INTEGER', 'DECIMAL', 'BOOLEAN', 'JSON') NOT NULL DEFAULT 'STRING' COMMENT '参数类型',
    category VARCHAR(50) COMMENT '参数分类',
    description TEXT COMMENT '参数描述',
    is_system TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否系统参数',
    is_encrypted TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否加密',
    sort_order INT DEFAULT 0 COMMENT '排序',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人'
);

-- 索引
CREATE INDEX idx_system_parameters_key ON system_parameters(param_key);
CREATE INDEX idx_system_parameters_category ON system_parameters(category);
CREATE INDEX idx_system_parameters_is_system ON system_parameters(is_system);
```

#### 2.7.2 会计期间表 (accounting_periods)
```sql
CREATE TABLE accounting_periods (
    id VARCHAR(36) PRIMARY KEY COMMENT '期间ID',
    fiscal_year INT NOT NULL COMMENT '会计年度',
    period INT NOT NULL COMMENT '会计期间',
    period_name VARCHAR(50) NOT NULL COMMENT '期间名称',
    start_date BIGINT NOT NULL COMMENT '开始日期',
    end_date BIGINT NOT NULL COMMENT '结束日期',
    status ENUM('OPEN', 'CLOSED', 'LOCKED') NOT NULL DEFAULT 'OPEN' COMMENT '期间状态',
    closed_by VARCHAR(36) COMMENT '关闭人',
    closed_at BIGINT COMMENT '关闭时间',
    created_at BIGINT NOT NULL COMMENT '创建时间',
    updated_at BIGINT NOT NULL COMMENT '更新时间',
    created_by VARCHAR(36) COMMENT '创建人',
    updated_by VARCHAR(36) COMMENT '更新人',
    UNIQUE KEY uk_fiscal_period (fiscal_year, period)
);

-- 索引
CREATE INDEX idx_accounting_periods_year ON accounting_periods(fiscal_year);
CREATE INDEX idx_accounting_periods_status ON accounting_periods(status);
CREATE INDEX idx_accounting_periods_dates ON accounting_periods(start_date, end_date);
```

## 3. 数据初始化脚本

### 3.1 基础资源数据
```sql
-- 插入基础资源（根据前端页面结构）
-- 顶级菜单
INSERT INTO tb_resource (id, create_time, update_time, create_by, update_by, resource_code, resource_name, resource_type, parent_id, url, icon, sort_order, path, level, description, deleted) VALUES
('res-001', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'BASIC_SETTINGS', '基础设置', 'TOP_MENU', NULL, NULL, 'Setting', 1, '/res-001', 1, '基础设置模块', 0),
('res-002', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'DAILY_ACCOUNTING', '日常核算', 'TOP_MENU', NULL, NULL, 'Document', 2, '/res-002', 1, '日常核算模块', 0),
('res-003', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'REPORT_MANAGEMENT', '报表管理', 'TOP_MENU', NULL, NULL, 'DataAnalysis', 3, '/res-003', 1, '报表管理模块', 0);

-- 基础设置子菜单
INSERT INTO tb_resource (id, create_time, update_time, create_by, update_by, resource_code, resource_name, resource_type, parent_id, url, icon, sort_order, path, level, description, deleted) VALUES
('res-011', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'CHART_OF_ACCOUNTS', '科目管理', 'SUB_MENU', 'res-001', '/settings/account', NULL, 1, '/res-001/res-011', 2, '会计科目管理', 0),
('res-012', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'AUXILIARY_ACCOUNTING', '辅助核算', 'SUB_MENU', 'res-001', '/settings/auxiliary', NULL, 2, '/res-001/res-012', 2, '辅助核算设置', 0),
('res-013', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'INITIAL_BALANCE', '期初余额', 'SUB_MENU', 'res-001', '/settings/balance', NULL, 3, '/res-001/res-013', 2, '期初余额设置', 0),
('res-014', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'CURRENCY_RATE', '币种汇率', 'SUB_MENU', 'res-001', '/settings/currency', NULL, 4, '/res-001/res-014', 2, '币种汇率管理', 0),
('res-015', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'SYSTEM_PARAMS', '系统参数', 'SUB_MENU', 'res-001', '/settings/system', NULL, 5, '/res-001/res-015', 2, '系统参数设置', 0),
('res-016', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ORGANIZATION', '组织架构', 'SUB_MENU', 'res-001', '/settings/organization', NULL, 6, '/res-001/res-016', 2, '组织架构管理', 0),
('res-017', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_PERMISSION', '用户权限', 'SUB_MENU', 'res-001', '/settings/permission', NULL, 7, '/res-001/res-017', 2, '用户权限管理', 0);

-- 用户权限按钮级权限
INSERT INTO tb_resource (id, create_time, update_time, create_by, update_by, resource_code, resource_name, resource_type, parent_id, url, icon, sort_order, path, level, description, deleted) VALUES
-- 用户管理按钮
('res-0171', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_ADD', '新增用户', 'BUTTON', 'res-017', NULL, NULL, 1, '/res-001/res-017/res-0171', 3, '新增用户按钮', 0),
('res-0172', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_EDIT', '编辑', 'BUTTON', 'res-017', NULL, NULL, 2, '/res-001/res-017/res-0172', 3, '编辑用户按钮', 0),
('res-0173', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_DELETE', '删除', 'BUTTON', 'res-017', NULL, NULL, 3, '/res-001/res-017/res-0173', 3, '删除用户按钮', 0),
('res-0174', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_RESET_PWD', '重置密码', 'BUTTON', 'res-017', NULL, NULL, 4, '/res-001/res-017/res-0174', 3, '重置密码按钮', 0),
('res-0175', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'USER_EXPORT', '导出用户', 'BUTTON', 'res-017', NULL, NULL, 5, '/res-001/res-017/res-0175', 3, '导出用户按钮', 0),
-- 角色管理按钮
('res-0176', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ROLE_ADD', '新增角色', 'BUTTON', 'res-017', NULL, NULL, 6, '/res-001/res-017/res-0176', 3, '新增角色按钮', 0),
('res-0177', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ROLE_EDIT', '编辑', 'BUTTON', 'res-017', NULL, NULL, 7, '/res-001/res-017/res-0177', 3, '编辑角色按钮', 0),
('res-0178', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ROLE_DELETE', '删除', 'BUTTON', 'res-017', NULL, NULL, 8, '/res-001/res-017/res-0178', 3, '删除角色按钮', 0),
('res-0179', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ROLE_CONFIG', '权限配置', 'BUTTON', 'res-017', NULL, NULL, 9, '/res-001/res-017/res-0179', 3, '角色权限配置按钮', 0);

-- 日常核算子菜单
INSERT INTO tb_resource (id, create_time, update_time, create_by, update_by, resource_code, resource_name, resource_type, parent_id, url, icon, sort_order, path, level, description, deleted) VALUES
('res-021', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'VOUCHER_ENTRY', '凭证录入', 'SUB_MENU', 'res-002', '/voucher/entry', NULL, 1, '/res-002/res-021', 2, '凭证录入', 0),
('res-022', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'VOUCHER_REVIEW', '凭证审核', 'SUB_MENU', 'res-002', '/voucher/review', NULL, 2, '/res-002/res-022', 2, '凭证审核', 0),
('res-023', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'VOUCHER_POSTING', '凭证记账', 'SUB_MENU', 'res-002', '/voucher/posting', NULL, 3, '/res-002/res-023', 2, '凭证记账', 0),
('res-024', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'VOUCHER_QUERY', '凭证查询', 'SUB_MENU', 'res-002', '/voucher/query', NULL, 4, '/res-002/res-024', 2, '凭证查询', 0),
('res-025', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'BOOK_QUERY', '账簿查询', 'SUB_MENU', 'res-002', '/voucher/books', NULL, 5, '/res-002/res-025', 2, '账簿查询', 0),
('res-026', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'PERIOD_CLOSING', '期末结账', 'SUB_MENU', 'res-002', '/voucher/closing', NULL, 6, '/res-002/res-026', 2, '期末结账', 0);

-- 报表管理子菜单
INSERT INTO tb_resource (id, create_time, update_time, create_by, update_by, resource_code, resource_name, resource_type, parent_id, url, icon, sort_order, path, level, description, deleted) VALUES
('res-031', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'BALANCE_SHEET', '资产负债表', 'SUB_MENU', 'res-003', '/reports/balance-sheet', NULL, 1, '/res-003/res-031', 2, '资产负债表', 0),
('res-032', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'INCOME_STATEMENT', '利润表', 'SUB_MENU', 'res-003', '/reports/income', NULL, 2, '/res-003/res-032', 2, '利润表', 0),
('res-033', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'CASH_FLOW', '现金流量表', 'SUB_MENU', 'res-003', '/reports/cash-flow', NULL, 3, '/res-003/res-033', 2, '现金流量表', 0),
('res-034', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'FINANCIAL_ANALYSIS', '财务分析', 'SUB_MENU', 'res-003', '/reports/analysis', NULL, 4, '/res-003/res-034', 2, '财务分析', 0);
```

### 3.2 基础角色数据
```sql
-- 插入基础角色
INSERT INTO tb_role (id, create_time, update_time, create_by, update_by, role_code, name, description, status, can_delete, can_modify, user_count, deleted) VALUES
('role-001', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'SUPER_ADMIN', '超级管理员', '系统超级管理员，拥有所有权限', 'ACTIVE', 0, 0, 1, 0),
('role-002', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'FINANCE_MANAGER', '财务主管', '负责凭证审核、报表查看等', 'ACTIVE', 1, 1, 0, 0),
('role-003', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'ACCOUNTANT', '会计', '负责凭证录入、账簿查询等', 'ACTIVE', 1, 1, 0, 0),
('role-004', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'CASHIER', '出纳', '负责现金日记账、银行对账等', 'ACTIVE', 1, 1, 0, 0),
('role-005', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'AUDITOR', '审计员', '负责查看报表、审计核查等', 'ACTIVE', 1, 1, 0, 0);
```

### 3.3 基础用户数据
```sql
-- 插入默认管理员用户（密码: admin123）
INSERT INTO tb_user (id, create_time, update_time, create_by, update_by, username, password, real_name, email, phone, department, department_id, status, last_login_at, last_login_ip, deleted) VALUES
('user-001', UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 'admin', '$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu', '系统管理员', 'admin@company.com', '13800000000', '信息技术部', NULL, 'ACTIVE', NULL, NULL, 0);

-- 关联用户角色
INSERT INTO tb_user_role (id, create_time, create_by, user_id, role_id) VALUES
('ur-001', UNIX_TIMESTAMP(NOW())*1000, 'system', 'user-001', 'role-001');
```

### 3.4 角色资源关联数据
```sql
-- 超级管理员拥有所有资源权限
INSERT INTO tb_role_resource (id, create_time, create_by, role_id, resource_id)
SELECT 
    UUID(), 
    UNIX_TIMESTAMP(NOW())*1000, 
    'system', 
    'role-001', 
    id 
FROM tb_resource;

-- 财务主管权限（除用户权限管理外的所有权限）
INSERT INTO tb_role_resource (id, create_time, create_by, role_id, resource_id)
SELECT 
    UUID(), 
    UNIX_TIMESTAMP(NOW())*1000, 
    'system', 
    'role-002', 
    id 
FROM tb_resource 
WHERE resource_code NOT IN ('USER_PERMISSION', 'USER_ADD', 'USER_EDIT', 'USER_DELETE', 'USER_RESET_PWD', 'USER_EXPORT', 
                          'ROLE_ADD', 'ROLE_EDIT', 'ROLE_DELETE', 'ROLE_CONFIG');

-- 会计权限（凭证录入、查询、账簿查询）
INSERT INTO tb_role_resource (id, create_time, create_by, role_id, resource_id)
SELECT 
    UUID(), 
    UNIX_TIMESTAMP(NOW())*1000, 
    'system', 
    'role-003', 
    id 
FROM tb_resource 
WHERE resource_code IN ('VOUCHER_ENTRY', 'VOUCHER_QUERY', 'BOOK_QUERY', 'CHART_OF_ACCOUNTS', 
                       'AUXILIARY_ACCOUNTING', 'INITIAL_BALANCE', 'CURRENCY_RATE');
```

### 3.5 基础币种数据
```sql
-- 插入基础币种
INSERT INTO currencies (id, code, name, name_en, symbol, is_base, decimal_places, status, sort_order, created_at, updated_at, created_by, updated_by, deleted) VALUES
('curr-001', 'CNY', '人民币', 'Chinese Yuan', '￥', 1, 2, 1, 1, UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 0),
('curr-002', 'USD', '美元', 'US Dollar', '$', 0, 2, 1, 2, UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 0),
('curr-003', 'EUR', '欧元', 'Euro', '€', 0, 2, 1, 3, UNIX_TIMESTAMP(NOW())*1000, UNIX_TIMESTAMP(NOW())*1000, 'system', 'system', 0);
```

## 4. 约束与规范

### 4.1 字段规范
- 所有ID字段使用VARCHAR(36)存储UUID
- 金额字段统一使用DECIMAL(15,2)
- 时间字段使用BIGINT存储毫秒时间戳
- 状态字段优先使用ENUM类型
- 布尔字段使用TINYINT(1)

### 4.2 索引策略
- 主键自动创建聚集索引
- 外键字段创建普通索引
- 常用查询条件字段创建索引
- 组合查询创建复合索引

### 4.3 数据完整性
- 设置适当的外键约束
- 使用唯一约束防止重复数据
- 设置非空约束确保必需字段
- 使用CHECK约束验证数据范围

### 4.4 性能优化
- 合理设计索引提高查询性能
- 避免过多的外键约束影响写入性能
- 对大表考虑分区策略
- 定期维护统计信息

### 4.5 注意事项
- 系统不使用version字段进行乐观锁控制
- 所有并发控制通过业务逻辑层实现
- 审计跟踪通过created_at/updated_at/created_by/updated_by字段实现

这份重构版数据库设计完全基于前端功能需求和技术约束文档，确保能够支持系统的所有业务功能，并为后续开发提供坚实的数据基础。