# 财务管理系统测试指南

## 🎯 当前可测试功能

### 1. **用户认证模块** ✅
- 用户注册
- 用户登录  
- 令牌刷新
- 获取当前用户信息
- 修改密码
- 用户登出

### 2. **用户管理模块** ✅
- 用户查询（分页）
- 创建用户
- 更新用户信息
- 重置用户密码
- 删除用户
- 用户角色管理

### 3. **角色权限模块** ✅
- 角色查询
- 权限查询
- 角色权限管理

### 4. **科目管理模块** ✅
- 科目创建
- 科目查询
- 科目树结构
- 科目更新
- 科目删除

### 5. **期初余额模块** ✅
- 期初余额设置
- 试算平衡检查
- 期初余额确认

---

## 🧪 测试方法

### 方法一：使用 cURL 命令行测试

#### 1. **健康检查**
```bash
curl -X GET "http://localhost:8080/api/health/check"
```

#### 2. **用户注册**
```bash
curl -X POST "http://localhost:8080/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "test123456",
    "confirmPassword": "test123456",
    "email": "test@example.com",
    "realName": "测试用户",
    "departmentId": "DEPT001"
  }'
```

#### 3. **用户登录**
```bash
curl -X POST "http://localhost:8080/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }'
```

#### 4. **获取当前用户信息**（需要先登录获取token）
```bash
curl -X GET "http://localhost:8080/api/auth/me" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

#### 5. **科目查询**
```bash
curl -X GET "http://localhost:8080/api/accounts?page=0&size=10" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

### 方法二：使用 Postman 测试

我将为您创建一个 Postman 集合文件，包含所有API的测试用例。

### 方法三：使用 Swagger UI 测试

访问：http://localhost:8080/api/swagger-ui.html （如果启用了Swagger）

---

## 📋 推荐测试流程

### 阶段一：认证功能测试
1. ✅ 健康检查
2. 🔐 用户注册
3. 🔑 用户登录
4. 👤 获取用户信息
5. 🔄 刷新令牌
6. 🔒 修改密码
7. 🚪 用户登出

### 阶段二：用户管理测试
1. 👥 查询用户列表
2. ➕ 创建新用户
3. ✏️ 更新用户信息
4. 🔑 重置用户密码
5. 🗑️ 删除用户

### 阶段三：权限管理测试
1. 👑 查询角色列表
2. 🛡️ 查询权限列表
3. 🔗 用户角色分配

### 阶段四：业务功能测试
1. 📊 科目管理
2. 💰 期初余额设置
3. ⚖️ 试算平衡检查

---

## 🚀 快速开始测试

### 1. 确认应用运行状态
```bash
curl http://localhost:8080/api/health/check
```

### 2. 使用默认管理员账号登录
```bash
curl -X POST "http://localhost:8080/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }'
```

### 3. 保存返回的token，用于后续API调用

### 4. 测试具体功能
- 使用保存的token在Authorization header中
- 格式：`Authorization: Bearer YOUR_TOKEN`

---

## 🐛 常见问题

### Q1: 401 Unauthorized
- 检查token是否正确
- 检查token是否过期
- 确认Authorization header格式正确

### Q2: 403 Forbidden  
- 检查用户是否有相应权限
- 确认角色配置正确

### Q3: 404 Not Found
- 检查API路径是否正确
- 确认应用context-path为/api

### Q4: 500 Internal Server Error
- 检查数据库连接
- 查看应用日志排查问题

---

## 📊 测试数据

### 默认管理员账号
- **用户名**: admin
- **密码**: admin123

### 默认角色
- 超级管理员
- 管理员  
- 会计
- 出纳
- 审计员
- 查看者

### 默认权限
- 用户管理权限
- 凭证管理权限
- 报表查看权限
- 等等...

---

**更新时间**: 2025-08-20 12:10