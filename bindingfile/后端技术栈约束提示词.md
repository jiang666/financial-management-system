# åç«¯æŠ€æœ¯æ ˆçº¦æŸæç¤ºè¯

## ğŸ”§ åç«¯æŠ€æœ¯æ ˆçº¦æŸè§„èŒƒ

### å¿…é¡»ä½¿ç”¨çš„æ ¸å¿ƒæŠ€æœ¯æ ˆ

```
è¯·ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹åç«¯æŠ€æœ¯æ ˆè¿›è¡Œå¼€å‘ï¼Œä¸å¾—ä½¿ç”¨ç¦ç”¨æ¸…å•ä¸­çš„æŠ€æœ¯ï¼š

## æ ¸å¿ƒæ¡†æ¶ (å¿…é¡»ä½¿ç”¨)
- Spring Boot (ä¸»æ¡†æ¶)
- Spring Data JPA (å…³ç³»å‹æ•°æ®åº“æŒä¹…å±‚)
- Spring Data MongoDB (MongoDBæŒä¹…å±‚)
- Spring Security (æƒé™è®¤è¯)
- Lombok (ç®€åŒ–ä»£ç æ³¨è§£)
- @Slf4j (æ—¥å¿—æ³¨è§£) 
- Python (AIç›¸å…³åŠŸèƒ½)

## æ•°æ®åº“çº¦æŸ (ä»…é™ä»¥ä¸‹ä¸‰ç§)
1. **MySQL** - ä¸»è¦ä¸šåŠ¡æ•°æ®å­˜å‚¨
2. **MongoDB** - æ–‡æ¡£å‹æ•°æ®å­˜å‚¨
3. **PostgreSQL** - AIå‘é‡æ•°æ®å­˜å‚¨ (pgvectoræ‰©å±•)

## å¿…ç”¨æ³¨è§£è§„èŒƒ
1. @Slf4j - æ‰€æœ‰ç±»å¿…é¡»ä½¿ç”¨æ­¤æ—¥å¿—æ³¨è§£
2. Lombokæ³¨è§£æ—ï¼š
   - @Data (getter/setter/toString/equals/hashCode)
   - @Entity (JPAå®ä½“)
   - @Document (MongoDBæ–‡æ¡£)
   - @NoArgsConstructor / @AllArgsConstructor
   - @Builder (å»ºé€ è€…æ¨¡å¼)
   - @Value (ä¸å¯å˜å¯¹è±¡)

## æ•°æ®è®¿é—®å±‚çº¦æŸ
- MySQLï¼šä½¿ç”¨Spring Data JPAï¼ŒRepositoryç»§æ‰¿JpaRepository
- MongoDBï¼šä½¿ç”¨Spring Data MongoDBï¼ŒRepositoryç»§æ‰¿MongoRepository
- PostgreSQLï¼šä½¿ç”¨Spring Data JPA + pgvectorï¼Œç”¨äºAIå‘é‡å­˜å‚¨
- è‡ªå®šä¹‰æŸ¥è¯¢ä½¿ç”¨@Queryæ³¨è§£
- å®ä½“å…³ç³»ä½¿ç”¨JPAæ³¨è§£(@OneToMany, @ManyToOneç­‰)

## å®ä½“ç±»è§„èŒƒ (å¿…é¡»éµå®ˆ)
### MySQLå®ä½“ç±» (JPA)
- å¿…é¡»æœ‰UUIDç±»å‹çš„ä¸»é”®id
- ä½¿ç”¨@Entityå’Œ@Tableæ³¨è§£
- ç¤ºä¾‹ï¼š
â€‹```java
@Entity
@Table(name = "users")
@Data
public class User {
    @Id
    @GeneratedValue(generator = "uuid")
    @GenericGenerator(name = "uuid", strategy = "uuid2")
    private String id; // å¿…é¡»ä¸ºUUIDç±»å‹
    
    private String username;
    // å…¶ä»–å­—æ®µ...
}
```

### MongoDBæ–‡æ¡£ç±»

- å¿…é¡»æœ‰UUIDç±»å‹çš„ä¸»é”®id
- ä½¿ç”¨@Documentæ³¨è§£
- ç¤ºä¾‹ï¼š

```java
@Document(collection = "logs")
@Data
public class LogDocument {
    @Id
    private String id; // MongoDBè‡ªåŠ¨ç”ŸæˆObjectIdï¼Œè½¬ä¸ºString
    
    private String content;
    private Date timestamp;
    // å…¶ä»–å­—æ®µ...
}
```

### PostgreSQLå‘é‡å®ä½“ç±» (AIç›¸å…³)

- ç”¨äºå­˜å‚¨AIå‘é‡æ•°æ®
- æ”¯æŒpgvectoræ‰©å±•
- ç¤ºä¾‹ï¼š

```java
@Entity
@Table(name = "embeddings")
@Data
public class Embedding {
    @Id
    @GeneratedValue(generator = "uuid")
    @GenericGenerator(name = "uuid", strategy = "uuid2")
    private String id;
    
    @Column(name = "vector", columnDefinition = "vector(1536)")
    private String vector; // å‘é‡æ•°æ®
    
    private String content; // åŸå§‹å†…å®¹
    // å…¶ä»–å­—æ®µ...
}
```

## æ¥å£è¿”å›å€¼è§„èŒƒ (å¿…é¡»ä½¿ç”¨)

- æ‰€æœ‰æ¥å£å¿…é¡»ä½¿ç”¨ç»Ÿä¸€çš„ResponseEntity<T>è¿”å›
- åˆ†é¡µæŸ¥è¯¢å¿…é¡»ä½¿ç”¨ResponsePageDataEntity<T>
- è¿”å›æ ¼å¼ï¼š

```java
// æˆåŠŸå“åº”
return ResponseEntity.success(data);

// å¤±è´¥å“åº”  
return ResponseEntity.fail("é”™è¯¯ä¿¡æ¯");

// åˆ†é¡µå“åº”
ResponsePageDataEntity<User> pageData = new ResponsePageDataEntity<>();
pageData.setTotal(total);
pageData.setRows(userList);
return ResponseEntity.success(pageData);
```

## æƒé™å®‰å…¨çº¦æŸ

- å¿…é¡»ä½¿ç”¨Spring Security
- JWT Tokenè®¤è¯æ–¹å¼
- è§’è‰²æƒé™æ§åˆ¶ä½¿ç”¨@PreAuthorizeæ³¨è§£
- å¯†ç åŠ å¯†ä½¿ç”¨BCryptPasswordEncoder

## AIåŠŸèƒ½çº¦æŸ

- Pythonè„šæœ¬å¤„ç†AIç›¸å…³ä¸šåŠ¡
- Javaè°ƒç”¨Pythoné€šè¿‡ProcessBuilderæˆ–RestTemplate
- AIæ¨¡å‹æ¨ç†ç»“æœé€šè¿‡JSONæ ¼å¼äº¤äº’

```
---

## âŒ ä¸¥ç¦ä½¿ç”¨æŠ€æœ¯æ¸…å•
```

ä»¥ä¸‹æŠ€æœ¯ä¸¥ç¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼š

## æ–‡æ¡£å·¥å…· (ç¦ç”¨)

âŒ Swagger / OpenAPI (ä»»ä½•ç‰ˆæœ¬) âŒ Knife4j âŒ SpringDoc âŒ ä»»ä½•APIæ–‡æ¡£ç”Ÿæˆå·¥å…·

## ç¼“å­˜æŠ€æœ¯ (ç¦ç”¨)

âŒ Redis (ä»»ä½•ç”¨é€”) âŒ Ehcache âŒ Caffeine âŒ Hazelcast âŒ å…¶ä»–ç¼“å­˜ä¸­é—´ä»¶

## æŒä¹…å±‚æ¡†æ¶ (ç¦ç”¨)

âŒ MyBatis (åŒ…æ‹¬MyBatis-Plus) âŒ MyBatis Generator âŒ ä»»ä½•SQLæ˜ å°„æ¡†æ¶ âŒ HibernateåŸç”ŸAPI (åªèƒ½ç”¨Spring Data JPAå°è£…)

## å…¶ä»–ç¦ç”¨æŠ€æœ¯

âŒ Shiro (æƒé™æ¡†æ¶ï¼Œå¿…é¡»ç”¨Spring Security) âŒ Druidè¿æ¥æ± é…ç½®é¡µé¢ âŒ å…¶ä»–éSpringç”Ÿæ€çš„æ¡†æ¶

```
---

## ğŸ“‹ æ ‡å‡†é¡¹ç›®ç»“æ„çº¦æŸ
```

src/main/java/com/company/project/ â”œâ”€â”€ controller/          # RESTæ¥å£å±‚ â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘å±‚
 â”œâ”€â”€ repository/         # æ•°æ®è®¿é—®å±‚(JPA) â”œâ”€â”€ entity/            # JPAå®ä½“ç±» â”œâ”€â”€ dto/               # æ•°æ®ä¼ è¾“å¯¹è±¡ â”œâ”€â”€ config/            # é…ç½®ç±» â”œâ”€â”€ security/          # Spring Securityé…ç½® â”œâ”€â”€ exception/         # å¼‚å¸¸å¤„ç† â”œâ”€â”€ util/              # å·¥å…·ç±» â”œâ”€â”€ ai/                # AIç›¸å…³åŠŸèƒ½(è°ƒç”¨Python) â””â”€â”€ common/            # é€šç”¨ç±»(ResponseEntityç­‰)

src/main/resources/ â”œâ”€â”€ application.yml     # é…ç½®æ–‡ä»¶ â”œâ”€â”€ data.sql           # åˆå§‹åŒ–æ•°æ® â””â”€â”€ python/            # Python AIè„šæœ¬

src/main/python/       # Python AIæ¨¡å— â”œâ”€â”€ models/            # AIæ¨¡å‹ â”œâ”€â”€ services/          # AIä¸šåŠ¡é€»è¾‘ â””â”€â”€ utils/             # Pythonå·¥å…·

```
---

## ğŸ¯ ä»£ç è§„èŒƒçº¦æŸ

### å¿…é¡»çš„æ³¨è§£ä½¿ç”¨
â€‹```java
// 1. MySQLå®ä½“ç±»å’ŒRepository
@Data
@Entity
@Table(name = "users")
public class User {
    @Id
    @GeneratedValue(generator = "uuid")
    @GenericGenerator(name = "uuid", strategy = "uuid2")
    private String id;
    
    private String username;
    private String email;
}

public interface UserRepository extends JpaRepository<User, String> {
    @Query("SELECT u FROM User u WHERE u.status = :status")
    List<User> findByStatus(@Param("status") String status);
}

// 2. MongoDBæ–‡æ¡£ç±»å’ŒRepository
@Data
@Document(collection = "system_logs")
public class SystemLog {
    @Id
    private String id;
    
    private String level;
    private String message;
    private Date timestamp;
}

public interface SystemLogRepository extends MongoRepository<SystemLog, String> {
    List<SystemLog> findByLevelAndTimestampBetween(
        String level, Date start, Date end);
}

// 3. PostgreSQLå‘é‡å®ä½“ç±» (AIç›¸å…³)
@Data
@Entity
@Table(name = "document_embeddings")
public class DocumentEmbedding {
    @Id
    @GeneratedValue(generator = "uuid")
    @GenericGenerator(name = "uuid", strategy = "uuid2")
    private String id;
    
    @Column(name = "vector", columnDefinition = "vector(1536)")
    private String vector;
    
    private String documentId;
    private String content;
}

public interface DocumentEmbeddingRepository extends JpaRepository<DocumentEmbedding, String> {
    @Query(value = "SELECT * FROM document_embeddings ORDER BY vector <-> CAST(?1 AS vector) LIMIT ?2", 
           nativeQuery = true)
    List<DocumentEmbedding> findSimilarVectors(String queryVector, int limit);
}

// 4. Controllerä½¿ç”¨ä¸åŒæ•°æ®æº
@RestController
@RequestMapping("/api")
@Slf4j
public class DataController {
    
    @Autowired
    private UserRepository userRepository; // MySQL
    
    @Autowired
    private SystemLogRepository logRepository; // MongoDB
    
    @Autowired
    private DocumentEmbeddingRepository embeddingRepository; // PostgreSQL
    
    @GetMapping("/users")
    public ResponseEntity<List<User>> getUsers() {
        List<User> users = userRepository.findAll();
        return ResponseEntity.success(users);
    }
    
    @GetMapping("/logs")
    public ResponseEntity<List<SystemLog>> getLogs() {
        List<SystemLog> logs = logRepository.findAll();
        return ResponseEntity.success(logs);
    }
    
    @PostMapping("/search-similar")
    public ResponseEntity<List<DocumentEmbedding>> searchSimilar(@RequestBody String vector) {
        List<DocumentEmbedding> similar = embeddingRepository.findSimilarVectors(vector, 10);
        return ResponseEntity.success(similar);
    }
}
### æ—¥å¿—è§„èŒƒ
â€‹```java
// å¿…é¡»ä½¿ç”¨@Slf4jï¼Œç¦ç”¨System.out.println
@Slf4j
@Service
public class BusinessService {
    
    public void processData() {
        log.info("å¼€å§‹å¤„ç†ä¸šåŠ¡æ•°æ®");
        try {
            // ä¸šåŠ¡é€»è¾‘
            log.debug("å¤„ç†è¯¦ç»†ä¿¡æ¯ï¼š{}", details);
        } catch (Exception e) {
            log.error("å¤„ç†å¤±è´¥ï¼š{}", e.getMessage(), e);
        }
        log.info("ä¸šåŠ¡æ•°æ®å¤„ç†å®Œæˆ");
    }
}
```

### AIåŠŸèƒ½é›†æˆè§„èŒƒ

```java
// Javaè°ƒç”¨Python AIæœåŠ¡çš„æ ‡å‡†æ–¹å¼
@Service
@Slf4j
public class AIService {
    
    @Autowired
    private DocumentEmbeddingRepository embeddingRepository;
    
    /**
     * æ–‡æœ¬å‘é‡åŒ–å¹¶å­˜å‚¨åˆ°PostgreSQL
     */
    public void generateAndStoreEmbedding(String content, String documentId) {
        try {
            // è°ƒç”¨PythonæœåŠ¡ç”Ÿæˆå‘é‡
            String vector = callPythonEmbeddingService(content);
            
            // å­˜å‚¨åˆ°PostgreSQL
            DocumentEmbedding embedding = new DocumentEmbedding();
            embedding.setContent(content);
            embedding.setDocumentId(documentId);
            embedding.setVector(vector);
            
            embeddingRepository.save(embedding);
            log.info("å‘é‡å­˜å‚¨å®Œæˆï¼šdocumentId={}", documentId);
            
        } catch (Exception e) {
            log.error("å‘é‡åŒ–å¤„ç†å¤±è´¥ï¼š{}", e.getMessage(), e);
            throw new AIProcessException("å‘é‡åŒ–å¤„ç†å¼‚å¸¸", e);
        }
    }
    
    /**
     * è¯­ä¹‰æœç´¢
     */
    public List<DocumentEmbedding> semanticSearch(String query, int limit) {
        try {
            // å°†æŸ¥è¯¢æ–‡æœ¬å‘é‡åŒ–
            String queryVector = callPythonEmbeddingService(query);
            
            // åœ¨PostgreSQLä¸­è¿›è¡Œå‘é‡ç›¸ä¼¼åº¦æœç´¢
            List<DocumentEmbedding> results = embeddingRepository
                .findSimilarVectors(queryVector, limit);
                
            log.info("è¯­ä¹‰æœç´¢å®Œæˆï¼Œè¿”å›{}æ¡ç»“æœ", results.size());
            return results;
            
        } catch (Exception e) {
            log.error("è¯­ä¹‰æœç´¢å¤±è´¥ï¼š{}", e.getMessage(), e);
            throw new AIProcessException("è¯­ä¹‰æœç´¢å¼‚å¸¸", e);
        }
    }
    
    private String callPythonEmbeddingService(String text) {
        // æ–¹å¼1ï¼šé€šè¿‡HTTPè°ƒç”¨PythonæœåŠ¡
        ResponseEntity<String> response = restTemplate.postForEntity(
            "http://ai-service:8080/embedding", text, String.class);
        return response.getBody();
    }
}
```

------

## ğŸ”’ å®‰å…¨é…ç½®çº¦æŸ

```java
// Spring Securityé…ç½®ç¤ºä¾‹
@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true)
@Slf4j
public class SecurityConfig {
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
    
    @Bean
    public JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint() {
        return new JwtAuthenticationEntryPoint();
    }
    
    // JWTé…ç½®...
}
```

------

## ğŸ“ å®Œæ•´å¼€å‘æç¤ºè¯æ¨¡æ¿

```
ã€åç«¯æŠ€æœ¯çº¦æŸã€‘
å¿…é¡»ä½¿ç”¨ï¼šSpring Boot + Spring Data JPA + Spring Data MongoDB + Spring Security + Lombok + @Slf4j + Python(AI)
æ•°æ®åº“é™åˆ¶ï¼šä»…é™MySQL(ä¸šåŠ¡æ•°æ®) + MongoDB(æ–‡æ¡£æ•°æ®) + PostgreSQL(AIå‘é‡æ•°æ®)
ä¸¥ç¦ä½¿ç”¨ï¼šSwaggeræ–‡æ¡£ã€Redisç¼“å­˜ã€MyBatisç³»åˆ—ã€Shiroæƒé™æ¡†æ¶

ã€ä»£ç è§„èŒƒã€‘
- æ‰€æœ‰ç±»å¿…é¡»ä½¿ç”¨@Slf4jæ—¥å¿—æ³¨è§£
- MySQLå®ä½“ï¼š@Entity + @Tableï¼ŒUUIDä¸»é”®ï¼ŒJpaRepository<Entity, String>
- MongoDBæ–‡æ¡£ï¼š@Documentï¼ŒMongoRepository<Document, String>
- PostgreSQLå‘é‡ï¼š@Entityï¼Œpgvectoræ‰©å±•ï¼Œå‘é‡ç›¸ä¼¼åº¦æœç´¢
- æƒé™æ§åˆ¶ä½¿ç”¨@PreAuthorizeæ³¨è§£
- AIåŠŸèƒ½ï¼šJavaè°ƒç”¨Pythonå‘é‡åŒ–æœåŠ¡ï¼Œå­˜å‚¨åˆ°PostgreSQL

ã€æ¥å£è¿”å›å€¼è§„èŒƒã€‘
- æ‰€æœ‰æ¥å£å¿…é¡»ä½¿ç”¨ResponseEntity<T>ç»Ÿä¸€è¿”å›æ ¼å¼
- æˆåŠŸï¼šResponseEntity.success(data)
- å¤±è´¥ï¼šResponseEntity.fail("é”™è¯¯ä¿¡æ¯")
- åˆ†é¡µï¼šResponseEntity.success(ResponsePageDataEntity<T>)

ã€æ•°æ®åº“ä½¿ç”¨åœºæ™¯ã€‘
- MySQLï¼šç”¨æˆ·ã€æƒé™ã€ä¸šåŠ¡æ ¸å¿ƒæ•°æ®
- MongoDBï¼šæ—¥å¿—ã€æ–‡æ¡£ã€éç»“æ„åŒ–æ•°æ®
- PostgreSQLï¼šAIå‘é‡ã€è¯­ä¹‰æœç´¢ã€æœºå™¨å­¦ä¹ ç‰¹å¾

ã€AIé›†æˆã€‘
Javaé€šè¿‡RestTemplateè°ƒç”¨Pythonå‘é‡åŒ–æœåŠ¡ï¼Œå‘é‡æ•°æ®å­˜å‚¨PostgreSQLè¿›è¡Œç›¸ä¼¼åº¦æœç´¢
```

------

## âœ… å¼€å‘æ£€æŸ¥æ¸…å•

**æŠ€æœ¯æ ˆæ£€æŸ¥ï¼š**

- [ ] ä½¿ç”¨Spring Bootæ¡†æ¶
- [ ] MySQLä½¿ç”¨Spring Data JPA
- [ ] MongoDBä½¿ç”¨Spring Data MongoDB
- [ ] PostgreSQLä½¿ç”¨Spring Data JPA + pgvector
- [ ] æƒé™ä½¿ç”¨Spring Security
- [ ] æ‰€æœ‰ç±»ä½¿ç”¨@Slf4jæ³¨è§£

**æ•°æ®åº“å®ä½“æ£€æŸ¥ï¼š**

- [ ] MySQLå®ä½“ä½¿ç”¨@Entity + UUIDä¸»é”®
- [ ] MongoDBæ–‡æ¡£ä½¿ç”¨@Documentæ³¨è§£
- [ ] PostgreSQLå‘é‡å®ä½“æ”¯æŒpgvector
- [ ] Repositoryé€‰æ‹©æ­£ç¡®ç±»å‹(JpaRepository/MongoRepository)

**æ¥å£è§„èŒƒæ£€æŸ¥ï¼š**

- [ ] æ‰€æœ‰æ¥å£ä½¿ç”¨ResponseEntity<T>è¿”å›
- [ ] åˆ†é¡µæŸ¥è¯¢ä½¿ç”¨ResponsePageDataEntity<T>
- [ ] æˆåŠŸå“åº”ä½¿ç”¨ResponseEntity.success()
- [ ] å¤±è´¥å“åº”ä½¿ç”¨ResponseEntity.fail()

**AIåŠŸèƒ½æ£€æŸ¥ï¼š**

- [ ] å‘é‡æ•°æ®å­˜å‚¨åˆ°PostgreSQL
- [ ] Javaé€šè¿‡RestTemplateè°ƒç”¨PythonæœåŠ¡
- [ ] å‘é‡ç›¸ä¼¼åº¦æœç´¢ä½¿ç”¨pgvector
- [ ] AIç›¸å…³å¼‚å¸¸æ­£ç¡®å¤„ç†

**ç¦ç”¨æŠ€æœ¯æ£€æŸ¥ï¼š**

- [ ] æœªä½¿ç”¨Swaggeræ–‡æ¡£å·¥å…·
- [ ] æœªä½¿ç”¨Redisç¼“å­˜
- [ ] æœªä½¿ç”¨MyBatisç³»åˆ—
- [ ] æœªä½¿ç”¨å…¶ä»–æ•°æ®åº“(ä»…MySQL/MongoDB/PostgreSQL)

è¿™æ ·å¯ä»¥ç¡®ä¿åç«¯å¼€å‘ä¸¥æ ¼éµå¾ªé¡¹ç›®çš„æŠ€æœ¯æ ˆçº¦æŸï¼